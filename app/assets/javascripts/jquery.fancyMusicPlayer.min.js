/*
* Fancy Music Player V2.2.2
* Author: Rafael Dery
* Copyright 2011
*
* Only for the sale at the envato marketplaces
*
*/

(function(e){e.fancyMusicPlayer={version:"2.2.2",author:"Rafael Dery"};jQuery.fn.fancyMusicPlayer=function(D){function F(){q.xmlPath?e.ajax({type:"GET",url:q.xmlPath,dataType:"xml",cache:!1,success:function(c){var g=e(c).find("playlists");c=q.xmlPlaylist?q.xmlPlaylist:g.children("playlist:first").attr("id");g.children('playlist[id="'+c+'"]').children("track").each(function(c,g){var l=e(g);m[c]=l.attr("href");j[c]=l.attr("title");b[c]=l.attr("target")});J();e(".fmp-xml-playlist").each(function(b,c){var l= e(c);l.append("<h3>"+c.title+'</h3><ul class="fmp-my-playlist"></ul>');g.children('playlist[id="'+c.id+'"]').children("track").each(function(b,c){var g=e(c),f=g.attr("target")?'target="'+g.attr("target")+'"':'target=" "';l.children("ul").append('<li><a href="'+g.attr("href")+'" title="'+g.attr("title")+'" '+f+">"+g.attr("title")+"</a></li>")})})},error:function(){alert("XML file could not be loaded. Please check the XML path!")}}):(f.children("a").hide().each(function(c,g){m[c]=g.href;j[c]=g.title; b[c]=g.target}),J())}function J(){f.find("p:first, div").remove();f.append('<div class="clearfix"><a href="#" class="fmp-previous-button fmp-previous-button-normal"><div class="fmp-previous"></div></a><a href="#" class="fmp-pp-button fmp-play-button-normal"><div class="fmp-play"></div></a><a href="#" class="fmp-next-button fmp-next-button-normal"><div class="fmp-next"></div></a><div class="fmp-time-bar"><div class="fmp-time"><span></span><div class="fmp-time-arrow-border"></div><div class="fmp-time-arrow"></div></div><div class="fmp-loading-bar"></div><div class="fmp-progress-bar"></div><div class="fmp-time-slider"></div></div></div>'); G=f.find(".fmp-time-bar").width();f.children("div:first").disableSelection();f.find(".fmp-time").css({opacity:0,top:-40});e.support.leadingWhitespace||f.find(".fmp-time").children(".fmp-time-arrow-border, .fmp-time-arrow").hide();q.volume&&f.find("div:first").append('<div class="fmp-sound-control"><div class="fmp-volume-button fmp-button-normal"></div><div class="fmp-volume-bar"><div class="fmp-volume-arrow-border"></div><div class="fmp-volume-arrow"></div><div class="fmp-volume-slider"></div><div class="fmp-volume-state-background"><div class="fmp-volume-state"></div></div></div></div>'); if(q.playlist){f.append('<div class="fmp-tracks-container clearfix"><div class="fmp-playlist-button fmp-button-normal"></div><span class="fmp-current-title"></span></div><div class="fmp-playlist-container" style="height:'+q.playlistHeight+'px;"><ul class="fmp-playlist"></ul></div>');for(var l=0;l<j.length;++l)E(l,j[l],b[l])}else f.append('<div class="fmp-tracks-container clearfix"><span class="fmp-current-title"></span></div>');f.find(".fmp-pp-button").hover(function(){var b=e(this);k?b.removeClass("fmp-play-button-normal").addClass("fmp-play-button-hover"): b.removeClass("fmp-pause-button-normal").addClass("fmp-pause-button-hover")},function(){var b=e(this);k?b.removeClass("fmp-play-button-hover").addClass("fmp-play-button-normal"):b.removeClass("fmp-pause-button-hover").addClass("fmp-pause-button-normal")});f.find(".fmp-previous-button").hover(function(){e(this).removeClass("fmp-previous-button-normal").addClass("fmp-previous-button-hover").children("div").stop().fadeTo(500,1)},function(){e(this).removeClass("fmp-previous-button-hover fmp-previous-button-press").addClass("fmp-previous-button-normal").children("div").stop().fadeTo(400, 0.8)}).children("div").fadeTo(0,0.8);f.find(".fmp-next-button").hover(function(){e(this).removeClass("fmp-next-button-normal").addClass("fmp-next-button-hover").children("div").stop().fadeTo(500,1)},function(){e(this).removeClass("fmp-next-button-hover fmp-next-button-press").addClass("fmp-next-button-normal").children("div").stop().fadeTo(400,0.8)}).children("div").fadeTo(0,0.8);f.find(".fmp-time-slider").hover(function(){if(0<m.length){var b=f.find(".fmp-time").data("hover",!0);c||b.stop().css({opacity:0, top:-40}).animate({opacity:1,top:-30},300)}},function(){if(0<m.length){var b=f.find(".fmp-time").data("hover",!1);c||b.stop().animate({opacity:0,top:-40},200)}});e(".fmp-previous-button").mouseup(function(){e(this).removeClass("fmp-previous-button-press").addClass("fmp-previous-button-hover")}).mousedown(function(){e(this).removeClass("fmp-previous-button-hover").addClass("fmp-previous-button-press")});e(".fmp-next-button").mouseup(function(){e(this).removeClass("fmp-next-button-press").addClass("fmp-next-button-hover")}).mousedown(function(){e(this).removeClass("fmp-next-button-hover").addClass("fmp-next-button-press")}); f.delegate(".fmp-playlist li span","mouseover mouseout",function(b){if("mouseover"==b.type){b=e(this);if(f.find(".fmp-playlist li").index(b.parent())==p)return!1;b.stop().animate({color:q.trackColorHover},500)}else{b=e(this);if(f.find(".fmp-playlist li").index(b.parent())==p)return!1;b.stop().animate({color:q.trackColorNormal},500)}}).addClass("fmp-track-normal");f.delegate(".fmp-delete-track, .fmp-track-link","mouseover mouseout",function(b){"mouseover"==b.type?e(this).stop().fadeTo(500,1):e(this).stop().fadeTo(500, 0.6)});f.find(".fmp-previous-button").click(function(){e.fancyMusicPlayer.previous();return!1});f.find(".fmp-next-button").click(function(){e.fancyMusicPlayer.next();return!1});f.find(".fmp-pp-button").click(function(){e.fancyMusicPlayer.toggle();return!1});f.delegate(".fmp-time-slider","mousedown",function(){e(document).bind("mouseup",z);e(document).bind("mousemove",A)});f.find(".fmp-volume-button").click(function(){if(!f.find(".fmp-volume-bar").is(":animated")){var b=e(this);b.hasClass("fmp-button-active")? b.removeClass("fmp-button-active").addClass("fmp-button-normal"):b.removeClass("fmp-button-normal").addClass("fmp-button-active");f.find(".fmp-volume-bar").slideToggle(200)}});f.delegate(".fmp-volume-slider","mousedown",function(){e(document).bind("mouseup",H);e(document).bind("mousemove",B)}).dblclick(function(){0==f.find(".fmp-volume-slider").position().top?e.fancyMusicPlayer.volume(1):e.fancyMusicPlayer.volume(0)});f.find(".fmp-playlist-button").click(function(){var b=e(this);f.find(".fmp-playlist-container").is(":animated")|| (b.hasClass("fmp-button-active")?b.removeClass("fmp-button-active").addClass("fmp-button-normal"):b.removeClass("fmp-button-normal").addClass("fmp-button-active"),f.find(".fmp-playlist-container").slideToggle(500))});f.delegate(".fmp-playlist li .fmp-delete-track","click",function(){var c=e(this),l=f.find(".fmp-playlist li").index(c.parent());m.splice(l,1);j.splice(l,1);b.splice(l,1);c.parent().remove();for(c=l;c<f.find(".fmp-playlist li").length;++c)f.find(".fmp-playlist li").eq(c).children("span").text(c+ 1+"- "+j[c]+"")});f.delegate(".fmp-playlist li span","click",function(){p=f.find(".fmp-playlist li").index(e(this).parent());x(p,!0)});f.delegate(".fmp-playlist li .fmp-track-link","click",function(){var c=f.find(".fmp-playlist li").index(e(this).parent());window.open(b[c],q.targetLink)});e(document).delegate(".fmp-my-playlist li a, a.fmp-my-track","click",function(){e.fancyMusicPlayer.addTrack(this.href,this.title,this.target);return!1});q.playlistScrollable?f.find(".fmp-playlist-container").niceScroll({autohidemode:!1, cursorwidth:4,cursorborder:"none"}):f.find(".fmp-playlist").unwrap();q.playlistInitOpen&&(f.find(".fmp-playlist-button").removeClass("fmp-button-normal").addClass("fmp-button-active"),f.find(".fmp-playlist-container").show());0<m.length&&x(q.startIndex,q.autoPlay);q.onReady()}function x(b,c){c?(f.find(".fmp-pp-button div").removeClass("fmp-play").addClass("fmp-pause"),f.find(".fmp-pp-button").removeClass("fmp-play-button-normal").addClass("fmp-pause-button-normal"),k=!1):(f.find(".fmp-pp-button div").removeClass("fmp-pause").addClass("fmp-play"), f.find(".fmp-pp-button").removeClass("fmp-pause-button-normal").addClass("fmp-play-button-normal"),k=!0);f.find(".fmp-playlist li span").stop().css("color",q.trackColorNormal).eq(b).css("color",q.trackColorSelected);f.find(".fmp-loading-bar").width(0);f.find(".fmp-progress-bar").width(0);f.find(".fmp-time").css("left",-13).find("span").text(q.showHours?"00:00:00":"00:00");f.find(".fmp-time-slider").css("left",-6);f.find(".fmp-current-title").text(j[b]);n&&n.destruct();n=soundManager.createSound({id:"fmp_sound", url:m[b],autoPlay:c,autoLoad:q.autoLoad,volume:s,whileloading:C,whileplaying:K,onfinish:u})}function C(){w=this.bytesLoaded/this.bytesTotal*G;f.find(".fmp-loading-bar").width(w)}function K(){var b,c=this.position/1E3,c=Math.abs(c);b=[];b[0]=Math.floor(c/3600%24);b[1]=Math.floor(c/60%60);b[2]=Math.floor(c%60);for(var c=q.showHours,e=-1,k=0;k<b.length;k++)10>b[k]&&(b[k]="0"+b[k]),"00"==b[k]&&k<b.length-2&&!c?e=k:c=!0;b.splice(0,e+1);b=b.join(":");y!=b&&(f.find(".fmp-time span").text(b),I(this.position/ this.duration));y=b}function u(){q.playNextWhenFinished?e.fancyMusicPlayer.next():(e.fancyMusicPlayer.pause(),n.setPosition(0),I(0))}function A(b){if(0==f.find(".fmp-loading-bar").width())return!1;c=!0;var e=f.find(".fmp-loading-bar").width()+-6;b=b.pageX-f.find(".fmp-progress-bar").offset().left-6;-6>b&&(b=-6);b>e&&(b=e);e=(b+6)/w;n.pause();n.setPosition(e*n.duration);I(e)}function z(){f.find(".fmp-time").data("hover")||f.find(".fmp-time").stop().animate({opacity:0,top:-40},200);if(0==f.find(".fmp-loading-bar").width())return!1; c=!1;e(document).unbind("mousemove",A);e(document).unbind("mouseup",z);k?n.pause():n.resume();n.duration==n.position&&u()}function B(b){var c=f.find(".fmp-volume-state-background").height()-4;b=b.pageY-f.find(".fmp-volume-state-background").offset().top;var k=(b+4)/44;0>b&&(k=b=0);b>c&&(k=1);e.fancyMusicPlayer.volume(k)}function H(){e(document).unbind("mousemove",B);e(document).unbind("mouseup",H)}function E(b,c,e){e=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)? '<div class="fmp-track-link"></div>':"";b=q.numberList?b+1+"- ":"";f.find(".fmp-playlist").append('<li><div class="fmp-delete-track"></div><span>'+b+c+"</span>"+e+"</li>");f.find(".fmp-playlist li:last").children(".fmp-delete-track, .fmp-track-link").fadeTo(0,0.6);f.children(".fmp-playlist-container").getNiceScroll().resize()}function I(b){f.find(".fmp-time").css("left",b*w-13);f.find(".fmp-time-slider").css("left",b*w-6);f.find(".fmp-progress-bar").width(b*w)}var q=e.extend({},e.fn.fancyMusicPlayer.defaults, D),f,n,y,G,w=0,p=q.startIndex,s,c=!1,k=!q.autoPlay,m=[],j=[],b=[];e.fancyMusicPlayer.play=function(){0<m.length&&(n.play(),f.find(".fmp-pp-button div").removeClass("fmp-play").addClass("fmp-pause"),f.find(".fmp-pp-button").removeClass("fmp-play-button-normal fmp-play-button-hover").addClass("fmp-pause-button-normal"),k=!1)};e.fancyMusicPlayer.pause=function(){0<m.length&&(0===m.length&&f.find(".fmp-current-title").text(""),n.pause(),f.find(".fmp-pp-button div").removeClass("fmp-pause").addClass("fmp-play"), f.find(".fmp-pp-button").removeClass("fmp-pause-button-normal fmp-pause-button-hover").addClass("fmp-play-button-normal"),k=!0)};e.fancyMusicPlayer.toggle=function(){k?e.fancyMusicPlayer.play():e.fancyMusicPlayer.pause()};e.fancyMusicPlayer.previous=function(){0<m.length&&(p--,0>p&&(p=m.length-1),x(p,!0))};e.fancyMusicPlayer.next=function(){0<m.length&&(p++,p==m.length?(p=0,x(p,q.loopPlaylist)):x(p,!0))};e.fancyMusicPlayer.volume=function(b){if(0<m.length){var c=f.find(".fmp-volume-state-background").height(); f.find(".fmp-volume-slider").css("top",(c-4)*b);f.find(".fmp-volume-state").css("height",c*b);s=100*b;n.setVolume(s)}};e.fancyMusicPlayer.addTrack=function(c,g,f,k){void 0===f&&(param2="");void 0===k&&(k=!0);var s=e.inArray(g,j);if(-1!=s)return x(s,k),!1;m.push(c);j.push(g);b.push(f);E(m.length-1,g,f);k&&(p=m.length-1,x(p,k))};e.fancyMusicPlayer.clear=function(){f.find(".fmp-current-title").text("");f.find(".fmp-playlist").empty();m=[];j=[];b=[];e.fancyMusicPlayer.pause();n.destruct()};return this.each(function(){f= e(this);f.addClass("fmp-container").append("<p>Initializing MP3-Player...</p>");soundManager.onready(F);soundManager.ontimeout(function(b){alert("SM2 failed to start. Flash missing, blocked or security error? Status: "+b.error.type)})})};e.fn.fancyMusicPlayer.defaults={playlistHeight:65,volume:!0,playlist:!0,playlistInitOpen:!1,playlistScrollable:!0,autoLoad:!0,autoPlay:!1,showHours:!1,numberList:!0,playNextWhenFinished:!0,trackColorNormal:"#8d8da8",trackColorHover:"#aeaec6",trackColorSelected:"#aeaec6", targetLink:"_blank",xmlPath:"",xmlPlaylist:"",startIndex:0,onReady:function(){},loopPlaylist:!0}})(jQuery); (function(e){var D=!1,F=!1,J=5E3,x=2E3,C=0,K,u=document.getElementsByTagName("script"),u=u[u.length-1].src.split("?")[0];K=0<u.split("/").length?u.split("/").slice(0,-1).join("/")+"/":"";var A=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||!1,z=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame|| window.msCancelRequestAnimationFrame||!1,B=window.MutationObserver||window.WebKitMutationObserver||!1,H={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1, bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0},E=!1,I=function(f,c){function k(){var d=b.win;if("zIndex"in d)return d.zIndex();for(;0<d.length&&9!=d[0].nodeType;){var c= d.css("zIndex");if(!isNaN(c)&&0!=c)return parseInt(c);d=d.parent()}return!1}function m(d,c,v){c=d.css(c);d=parseFloat(c);return isNaN(d)?(d=y[c]||0,v=3==d?v?b.win.outerHeight()-b.win.innerHeight():b.win.outerWidth()-b.win.innerWidth():1,b.isie8&&d&&(d+=1),v?d:0):d}function j(d,c,v){var e=0,g=0,f=1;"wheelDeltaY"in d?(f=b.opt.mousescrollstep/48,e=Math.floor(d.wheelDeltaX*f),g=Math.floor(d.wheelDeltaY*f),c&&0==e&&g&&(e=g,g=0)):(f=d.detail?-1*d.detail:d.wheelDelta/40)&&(c?e=Math.floor(f*b.opt.mousescrollstep): g=Math.floor(f*b.opt.mousescrollstep));e&&(b.scrollmom&&b.scrollmom.stop(),b.lastdeltax+=e,b.debounced("mousewheelx",function(){var d=b.lastdeltax;b.lastdeltax=0;b.rail.drag||b.doScrollLeftBy(d)},120));if(g){if(b.opt.nativeparentscrolling&&v)if(0>g){if(b.getScrollTop()>=b.page.maxh)return!0}else if(0>=b.getScrollTop())return!0;b.scrollmom&&b.scrollmom.stop();b.lastdeltay+=g;b.debounced("mousewheely",function(){var d=b.lastdeltay;b.lastdeltay=0;b.rail.drag||b.doScrollBy(d)},120)}return b.cancelEvent(d)} var b=this;this.version="3.2.0";this.name="nicescroll";this.me=c;this.opt={doc:e("body"),win:!1};e.extend(this.opt,H);this.opt.snapbackspeed=80;if(f)for(var l in b.opt)"undefined"!=typeof f[l]&&(b.opt[l]=f[l]);this.iddoc=(this.doc=b.opt.doc)&&this.doc[0]?this.doc[0].id||"":"";this.ispage=/BODY|HTML/.test(b.opt.win?b.opt.win[0].nodeName:this.doc[0].nodeName);this.haswrapper=!1!==b.opt.win;this.win=b.opt.win||(this.ispage?e(window):this.doc);this.docscroll=this.ispage&&!this.haswrapper?e(window):this.win; this.body=e("body");this.iframe=this.isfixed=this.viewport=!1;this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName;this.istextarea="TEXTAREA"==this.win[0].nodeName;this.forcescreen=!1;this.canshowonmouseevent="scroll"!=b.opt.autohidemode;this.page=this.view=this.onzoomout=this.onzoomin=this.onscrollcancel=this.onscrollend=this.onscrollstart=this.onclick=this.ongesturezoom=this.onkeypress=this.onmousewheel=this.onmousemove=this.onmouseup=this.onmousedown=!1;this.scroll={x:0, y:0};this.scrollratio={x:0,y:0};this.cursorheight=20;this.scrollvaluemax=0;this.observerremover=this.observer=this.scrollmom=this.scrollrunning=!1;do this.id="ascrail"+x++;while(document.getElementById(this.id));this.hasmousefocus=this.hasfocus=this.zoomactive=this.zoom=this.selectiondrag=this.cursorfreezed=this.cursor=this.rail=!1;this.visibility=!0;this.hidden=this.locked=!1;this.cursoractive=!0;this.nativescrollingarea=!1;this.checkarea=0;this.events=[];this.saved={};this.delaylist={};this.synclist= {};this.lastdeltay=this.lastdeltax=0;if(E)l=E;else{l=document.createElement("DIV");var g={haspointerlock:"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document};g.isopera="opera"in window;g.isopera12=g.isopera&&"getUserMedia"in navigator;g.isie="all"in document&&"attachEvent"in l&&!g.isopera;g.isieold=g.isie&&!("msInterpolationMode"in l.style);g.isie7=g.isie&&!g.isieold&&(!("documentMode"in document)||7==document.documentMode);g.isie8=g.isie&&"documentMode"in document&&8==document.documentMode;g.isie9=g.isie&&"performance"in window&&9<=document.documentMode;g.isie10=g.isie&&"performance"in window&&10<=document.documentMode;g.isie9mobile=/iemobile.9/i.test(navigator.userAgent);g.isie9mobile&&(g.isie9=!1);g.isie7mobile=!g.isie9mobile&&g.isie7&&/iemobile/i.test(navigator.userAgent);g.ismozilla="MozAppearance"in l.style;g.iswebkit="WebkitAppearance"in l.style;g.ischrome="chrome"in window;g.ischrome22=g.ischrome&&g.haspointerlock;g.ischrome26=g.ischrome&&"transition"in l.style;g.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window;g.hasmstouch=window.navigator.msPointerEnabled||!1;g.ismac=/^mac$/i.test(navigator.platform);g.isios=g.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform);g.isios4=g.isios&&!("seal"in Object);g.isandroid=/android/i.test(navigator.userAgent);g.trstyle=!1;g.hastransform=!1;g.hastranslate3d=!1;g.transitionstyle=!1;g.hastransition=!1;g.transitionend=!1;for(var n=["transform","msTransform","webkitTransform","MozTransform", "OTransform"],t=0;t<n.length;t++)if("undefined"!=typeof l.style[n[t]]){g.trstyle=n[t];break}g.hastransform=!1!=g.trstyle;g.hastransform&&(l.style[g.trstyle]="translate3d(1px,2px,3px)",g.hastranslate3d=/translate3d/.test(l.style[g.trstyle]));g.transitionstyle=!1;g.prefixstyle="";g.transitionend=!1;for(var n="transition webkitTransition MozTransition OTransition OTransition msTransition KhtmlTransition".split(" "),p=" -webkit- -moz- -o- -o -ms- -khtml-".split(" "),u="transitionend webkitTransitionEnd transitionend otransitionend oTransitionEnd msTransitionEnd KhtmlTransitionEnd".split(" "), t=0;t<n.length;t++)if(n[t]in l.style){g.transitionstyle=n[t];g.prefixstyle=p[t];g.transitionend=u[t];break}g.ischrome26&&(g.prefixstyle=p[1]);g.hastransition=g.transitionstyle;b:{n=["-moz-grab","-webkit-grab","grab"];if(g.ischrome&&!g.ischrome22||g.isie)n=[];for(t=0;t<n.length;t++)if(p=n[t],l.style.cursor=p,l.style.cursor==p){n=p;break b}n="url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}g.cursorgrabvalue=n;g.hasmousecapture="setCapture"in l;g.hasMutationObserver=!1!==B;l=E= g}this.detected=l;var h=e.extend({},this.detected);this.ishwscroll=(this.canhwscroll=h.hastransform&&b.opt.hwacceleration)&&b.haswrapper;this.istouchcapable=!1;h.cantouch&&h.ischrome&&(!h.isios&&!h.isandroid)&&(this.istouchcapable=!0,h.cantouch=!1);h.cantouch&&h.ismozilla&&!h.isios&&(this.istouchcapable=!0,h.cantouch=!1);b.opt.enablemouselockapi||(h.hasmousecapture=!1,h.haspointerlock=!1);this.delayed=function(d,c,e,g){var f=b.delaylist[d],h=(new Date).getTime();if(!g&&f&&f.tt)return!1;f&&f.tt&&clearTimeout(f.tt); if(f&&f.last+e>h&&!f.tt)b.delaylist[d]={last:h+e,tt:setTimeout(function(){b.delaylist[d].tt=0;c.call()},e)};else if(!f||!f.tt)b.delaylist[d]={last:h,tt:0},setTimeout(function(){c.call()},0)};this.debounced=function(d,c,e){var f=b.delaylist[d];(new Date).getTime();b.delaylist[d]=c;f||setTimeout(function(){var c=b.delaylist[d];b.delaylist[d]=!1;c.call()},e)};this.synched=function(d,c){b.synclist[d]=c;b.onsync||(A(function(){b.onsync=!1;for(d in b.synclist){var c=b.synclist[d];c&&c.call(b);b.synclist[d]= !1}}),b.onsync=!0);return d};this.unsynched=function(d){b.synclist[d]&&(b.synclist[d]=!1)};this.css=function(d,c){for(var e in c)b.saved.css.push([d,e,d.css(e)]),d.css(e,c[e])};this.scrollTop=function(d){return"undefined"==typeof d?b.getScrollTop():b.setScrollTop(d)};this.scrollLeft=function(d){return"undefined"==typeof d?b.getScrollLeft():b.setScrollLeft(d)};BezierClass=function(b,c,e,f,g,h,k){this.st=b;this.ed=c;this.spd=e;this.p1=f||0;this.p2=g||1;this.p3=h||0;this.p4=k||1;this.ts=(new Date).getTime(); this.df=this.ed-this.st};BezierClass.prototype={B2:function(b){return 3*b*b*(1-b)},B3:function(b){return 3*b*(1-b)*(1-b)},B4:function(b){return(1-b)*(1-b)*(1-b)},getNow:function(){var b=1-((new Date).getTime()-this.ts)/this.spd,c=this.B2(b)+this.B3(b)+this.B4(b);return 0>b?this.ed:this.st+Math.round(this.df*c)},update:function(b,c){this.st=this.getNow();this.ed=b;this.spd=c;this.ts=(new Date).getTime();this.df=this.ed-this.st;return this}};if(this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px", ty:"0px"};h.hastranslate3d&&h.isios&&this.doc.css("-webkit-backface-visibility","hidden");var w=function(){var d=b.doc.css(h.trstyle);return d&&"matrix"==d.substr(0,6)?d.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1};this.getScrollTop=function(d){if(!d){if(d=w())return 16==d.length?-d[13]:-d[5];if(b.timerscroll&&b.timerscroll.bz)return b.timerscroll.bz.getNow()}return b.doc.translate.y};this.getScrollLeft=function(d){if(!d){if(d=w())return 16==d.length?-d[12]:-d[4];if(b.timerscroll&& b.timerscroll.bh)return b.timerscroll.bh.getNow()}return b.doc.translate.x};this.notifyScrollEvent=document.createEvent?function(b){var c=document.createEvent("UIEvents");c.initUIEvent("scroll",!1,!0,window,1);b.dispatchEvent(c)}:document.fireEvent?function(b){var c=document.createEventObject();b.fireEvent("onscroll");c.cancelBubble=!0}:function(){};h.hastranslate3d&&b.opt.enabletranslate3d?(this.setScrollTop=function(d,c){b.doc.translate.y=d;b.doc.translate.ty=-1*d+"px";b.doc.css(h.trstyle,"translate3d("+ b.doc.translate.tx+","+b.doc.translate.ty+",0px)");c||b.notifyScrollEvent(b.win[0])},this.setScrollLeft=function(d,c){b.doc.translate.x=d;b.doc.translate.tx=-1*d+"px";b.doc.css(h.trstyle,"translate3d("+b.doc.translate.tx+","+b.doc.translate.ty+",0px)");c||b.notifyScrollEvent(b.win[0])}):(this.setScrollTop=function(d,c){b.doc.translate.y=d;b.doc.translate.ty=-1*d+"px";b.doc.css(h.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")");c||b.notifyScrollEvent(b.win[0])},this.setScrollLeft= function(d,c){b.doc.translate.x=d;b.doc.translate.tx=-1*d+"px";b.doc.css(h.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")");c||b.notifyScrollEvent(b.win[0])})}else this.getScrollTop=function(){return b.docscroll.scrollTop()},this.setScrollTop=function(d){return b.docscroll.scrollTop(d)},this.getScrollLeft=function(){return b.docscroll.scrollLeft()},this.setScrollLeft=function(d){return b.docscroll.scrollLeft(d)};this.getTarget=function(b){return!b?!1:b.target?b.target:b.srcElement? b.srcElement:!1};this.hasParent=function(b,c){if(!b)return!1;for(var e=b.target||b.srcElement||b||!1;e&&e.id!=c;)e=e.parentNode||!1;return!1!==e};var y={thin:1,medium:3,thick:5};this.getOffset=function(){if(b.isfixed)return{top:parseFloat(b.win.css("top")),left:parseFloat(b.win.css("left"))};if(!b.viewport)return b.win.offset();var d=b.win.offset(),c=b.viewport.offset();return{top:d.top-c.top+b.viewport.scrollTop(),left:d.left-c.left+b.viewport.scrollLeft()}};this.updateScrollBar=function(d){if(b.ishwscroll)b.rail.css({height:b.win.innerHeight()}), b.railh&&b.railh.css({width:b.win.innerWidth()});else{var c=b.getOffset(),e=c.top,f=c.left,e=e+m(b.win,"border-top-width",!0);b.win.outerWidth();b.win.innerWidth();var f=f+(b.rail.align?b.win.outerWidth()-m(b.win,"border-right-width")-b.rail.width:m(b.win,"border-left-width")),g=b.opt.railoffset;g&&(g.top&&(e+=g.top),b.rail.align&&g.left&&(f+=g.left));b.locked||b.rail.css({top:e,left:f,height:d?d.h:b.win.innerHeight()});b.zoom&&b.zoom.css({top:e+1,left:1==b.rail.align?f-20:f+b.rail.width+4});b.railh&& !b.locked&&(e=c.top,f=c.left,d=b.railh.align?e+m(b.win,"border-top-width",!0)+b.win.innerHeight()-b.railh.height:e+m(b.win,"border-top-width",!0),f+=m(b.win,"border-left-width"),b.railh.css({top:d,left:f,width:b.railh.width}))}};this.doRailClick=function(d,c,e){var f;!(b.rail.drag&&1!=b.rail.drag.pt)&&!b.locked&&!b.rail.drag&&(b.cancelScroll(),b.cancelEvent(d),c?(c=e?b.doScrollLeft:b.doScrollTop,f=e?(d.pageX-b.railh.offset().left-b.cursorwidth/2)*b.scrollratio.x:(d.pageY-b.rail.offset().top-b.cursorheight/ 2)*b.scrollratio.y,c(f)):(c=e?b.doScrollLeftBy:b.doScrollBy,f=e?b.scroll.x:b.scroll.y,d=e?d.pageX-b.railh.offset().left:d.pageY-b.rail.offset().top,e=e?b.view.w:b.view.h,f>=d?c(e):c(-e)))};b.hasanimationframe=A;b.hascancelanimationframe=z;b.hasanimationframe?b.hascancelanimationframe||(z=function(){b.cancelAnimationFrame=!0}):(A=function(b){return setTimeout(b,16)},z=clearInterval);this.init=function(){b.saved.css=[];if(h.isie7mobile)return!0;h.hasmstouch&&b.css(b.ispage?e("html"):b.win,{"-ms-touch-action":"none"}); b.zindex="auto";b.zindex=!b.ispage&&"auto"==b.opt.zindex?k():b.opt.zindex;!b.ispage&&b.zindex&&b.zindex>C&&(C=b.zindex);if(!b.ispage||!h.cantouch&&!h.isieold&&!h.isie9mobile){var d=b.docscroll;b.ispage&&(d=b.haswrapper?b.win:b.doc);h.isie9mobile||b.css(d,{"overflow-y":"hidden"});b.ispage&&h.isie7&&("BODY"==b.doc[0].nodeName?b.css(e("html"),{"overflow-y":"hidden"}):"HTML"==b.doc[0].nodeName&&b.css(e("body"),{"overflow-y":"hidden"}));h.isios&&!b.ispage&&!b.haswrapper&&b.css(e("body"),{"-webkit-overflow-scrolling":"touch"}); var c=e(document.createElement("div"));c.css({position:"relative",top:0,"float":"right",width:b.opt.cursorwidth,height:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius});c.hborder=parseFloat(c.outerHeight()-c.innerHeight());b.cursor=c;var f=e(document.createElement("div"));f.attr("id",b.id);f.addClass("nicescroll-rails"); var g,m,l=["left","right"],s;for(s in l)m=l[s],(g=b.opt.railpadding[m])?f.css("padding-"+m,g+"px"):b.opt.railpadding[m]=0;f.append(c);f.width=Math.max(parseFloat(b.opt.cursorwidth),c.outerWidth())+b.opt.railpadding.left+b.opt.railpadding.right;f.css({width:f.width+"px",zIndex:b.zindex,background:b.opt.background,cursor:"pointer"});f.visibility=!0;f.scrollable=!0;f.align="left"==b.opt.railalign?0:1;b.rail=f;c=b.rail.drag=!1;b.opt.boxzoom&&!b.ispage&&!h.isieold&&(c=document.createElement("div"),b.bind(c, "click",b.doZoom),b.zoom=e(c),b.zoom.css({cursor:"pointer","z-index":b.zindex,backgroundImage:"url("+K+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),b.opt.dblclickzoom&&b.bind(b.win,"dblclick",b.doZoom),h.cantouch&&b.opt.gesturezoom&&(b.ongesturezoom=function(d){1.5<d.scale&&b.doZoomIn(d);0.8>d.scale&&b.doZoomOut(d);return b.cancelEvent(d)},b.bind(b.win,"gestureend",b.ongesturezoom)));b.railh=!1;if(b.opt.horizrailenabled){b.css(d,{"overflow-x":"hidden"});c=e(document.createElement("div")); c.css({position:"relative",top:0,height:b.opt.cursorwidth,width:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius});c.wborder=parseFloat(c.outerWidth()-c.innerWidth());b.cursorh=c;var j=e(document.createElement("div"));j.attr("id",b.id+"-hr");j.addClass("nicescroll-rails");j.height=Math.max(parseFloat(b.opt.cursorwidth), c.outerHeight());j.css({height:j.height+"px",zIndex:b.zindex,background:b.opt.background,cursor:"pointer"});j.append(c);j.visibility=!0;j.scrollable=!0;j.align="top"==b.opt.railvalign?0:1;b.railh=j;b.railh.drag=!1}b.ispage?(f.css({position:"fixed",top:"0px",height:"100%"}),f.align?f.css({right:"0px"}):f.css({left:"0px"}),b.body.append(f),b.railh&&(j.css({position:"fixed",left:"0px",width:"100%"}),j.align?j.css({bottom:"0px"}):j.css({top:"0px"}),b.body.append(j))):(b.ishwscroll?("static"==b.win.css("position")&& b.css(b.win,{position:"relative"}),d="HTML"==b.win[0].nodeName?b.body:b.win,b.zoom&&(b.zoom.css({position:"absolute",top:1,right:0,"margin-right":f.width+4}),d.append(b.zoom)),f.css({position:"absolute",top:0}),f.align?f.css({right:0}):f.css({left:0}),d.append(f),j&&(j.css({position:"absolute",left:0,bottom:0}),j.align?j.css({bottom:0}):j.css({top:0}),d.append(j))):(b.isfixed="fixed"==b.win.css("position"),d=b.isfixed?"fixed":"absolute",b.isfixed||(b.viewport=b.getViewport(b.win[0])),b.viewport&& (b.body=b.viewport,!1==/relative|absolute/.test(b.viewport.css("position"))&&b.css(b.viewport,{position:"relative"})),f.css({position:d}),b.zoom&&b.zoom.css({position:d}),b.updateScrollBar(),b.body.append(f),b.zoom&&b.body.append(b.zoom),b.railh&&(j.css({position:d}),b.body.append(j))),h.isios&&b.css(b.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),h.isie&&b.opt.disableoutline&&b.win.attr("hideFocus","true"),h.iswebkit&&b.opt.disableoutline&&b.win.css({outline:"none"})); !1===b.opt.autohidemode?(b.autohidedom=!1,b.rail.css({opacity:b.opt.cursoropacitymax}),b.railh&&b.railh.css({opacity:b.opt.cursoropacitymax})):!0===b.opt.autohidemode?(b.autohidedom=e().add(b.rail),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh))):"scroll"==b.opt.autohidemode?(b.autohidedom=e().add(b.rail),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh))):"cursor"==b.opt.autohidemode?(b.autohidedom=e().add(b.cursor),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh.cursor))):"hidden"==b.opt.autohidemode&& (b.autohidedom=!1,b.hide(),b.locked=!1);if(h.isie9mobile)b.scrollmom=new q(b),b.onmangotouch=function(d){d=b.getScrollTop();var c=b.getScrollLeft();if(d==b.scrollmom.lastscrolly&&c==b.scrollmom.lastscrollx)return!0;var e=d-b.mangotouch.sy,f=c-b.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(f,2)+Math.pow(e,2)))){var r=0>e?-1:1,g=0>f?-1:1,h=+new Date;b.mangotouch.lazy&&clearTimeout(b.mangotouch.lazy);80<h-b.mangotouch.tm||b.mangotouch.dry!=r||b.mangotouch.drx!=g?(b.scrollmom.stop(),b.scrollmom.reset(c, d),b.mangotouch.sy=d,b.mangotouch.ly=d,b.mangotouch.sx=c,b.mangotouch.lx=c,b.mangotouch.dry=r,b.mangotouch.drx=g,b.mangotouch.tm=h):(b.scrollmom.stop(),b.scrollmom.update(b.mangotouch.sx-f,b.mangotouch.sy-e),b.mangotouch.tm=h,e=Math.max(Math.abs(b.mangotouch.ly-d),Math.abs(b.mangotouch.lx-c)),b.mangotouch.ly=d,b.mangotouch.lx=c,2<e&&(b.mangotouch.lazy=setTimeout(function(){b.mangotouch.lazy=!1;b.mangotouch.dry=0;b.mangotouch.drx=0;b.mangotouch.tm=0;b.scrollmom.doMomentum(30)},100)))}},f=b.getScrollTop(), j=b.getScrollLeft(),b.mangotouch={sy:f,ly:f,dry:0,sx:j,lx:j,drx:0,lazy:!1,tm:0},b.bind(b.docscroll,"scroll",b.onmangotouch);else{if(h.cantouch||b.istouchcapable||b.opt.touchbehavior||h.hasmstouch){b.scrollmom=new q(b);b.ontouchstart=function(d){if(d.pointerType&&2!=d.pointerType)return!1;if(!b.locked){if(h.hasmstouch)for(var c=d.target?d.target:!1;c;){var f=e(c).getNiceScroll();if(0<f.length&&f[0].me==b.me)break;if(0<f.length)return!1;if("DIV"==c.nodeName&&c.id==b.id)break;c=c.parentNode?c.parentNode: !1}b.cancelScroll();if((c=b.getTarget(d))&&/INPUT/i.test(c.nodeName)&&/range/i.test(c.type))return b.stopPropagation(d);!("clientX"in d)&&"changedTouches"in d&&(d.clientX=d.changedTouches[0].clientX,d.clientY=d.changedTouches[0].clientY);b.forcescreen&&(f=d,d={original:d.original?d.original:d},d.clientX=f.screenX,d.clientY=f.screenY);b.rail.drag={x:d.clientX,y:d.clientY,sx:b.scroll.x,sy:b.scroll.y,st:b.getScrollTop(),sl:b.getScrollLeft(),pt:2,dl:!1};if(b.ispage||!b.opt.directionlockdeadzone)b.rail.drag.dl= "f";else{var f=e(window).width(),r=e(window).height(),g=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),v=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),r=Math.max(0,v-r),f=Math.max(0,g-f);b.rail.drag.ck=!b.rail.scrollable&&b.railh.scrollable?0<r?"v":!1:b.rail.scrollable&&!b.railh.scrollable?0<f?"h":!1:!1;b.rail.drag.ck||(b.rail.drag.dl="f")}b.opt.touchbehavior&&b.isiframe&&h.isie&&(f=b.win.position(),b.rail.drag.x+=f.left,b.rail.drag.y+=f.top); b.hasmoving=!1;b.lastmouseup=!1;b.scrollmom.reset(d.clientX,d.clientY);if(!h.cantouch&&!this.istouchcapable&&!h.hasmstouch){if(!c||!/INPUT|SELECT|TEXTAREA/i.test(c.nodeName))return!b.ispage&&h.hasmousecapture&&c.setCapture(),b.cancelEvent(d);/SUBMIT|CANCEL|BUTTON/i.test(e(c).attr("type"))&&(pc={tg:c,click:!1},b.preventclick=pc)}}};b.ontouchend=function(d){if(d.pointerType&&2!=d.pointerType)return!1;if(b.rail.drag&&2==b.rail.drag.pt&&(b.scrollmom.doMomentum(),b.rail.drag=!1,b.hasmoving&&(b.hasmoving= !1,b.lastmouseup=!0,b.hideCursor(),h.hasmousecapture&&document.releaseCapture(),!h.cantouch)))return b.cancelEvent(d)};var n=b.opt.touchbehavior&&b.isiframe&&!h.hasmousecapture;b.ontouchmove=function(d,c){if(d.pointerType&&2!=d.pointerType)return!1;if(b.rail.drag&&2==b.rail.drag.pt){if(h.cantouch&&"undefined"==typeof d.original)return!0;b.hasmoving=!0;b.preventclick&&!b.preventclick.click&&(b.preventclick.click=b.preventclick.tg.onclick||!1,b.preventclick.tg.onclick=b.onpreventclick);d=e.extend({original:d}, d);"changedTouches"in d&&(d.clientX=d.changedTouches[0].clientX,d.clientY=d.changedTouches[0].clientY);if(b.forcescreen){var f=d;d={original:d.original?d.original:d};d.clientX=f.screenX;d.clientY=f.screenY}f=ofy=0;if(n&&!c){var r=b.win.position(),f=-r.left;ofy=-r.top}var g=d.clientY+ofy,r=g-b.rail.drag.y,v=d.clientX+f,k=v-b.rail.drag.x,j=b.rail.drag.st-r;b.ishwscroll&&b.opt.bouncescroll?0>j?j=Math.round(j/2):j>b.page.maxh&&(j=b.page.maxh+Math.round((j-b.page.maxh)/2)):(0>j&&(g=j=0),j>b.page.maxh&& (j=b.page.maxh,g=0));if(b.railh&&b.railh.scrollable){var m=b.rail.drag.sl-k;b.ishwscroll&&b.opt.bouncescroll?0>m?m=Math.round(m/2):m>b.page.maxw&&(m=b.page.maxw+Math.round((m-b.page.maxw)/2)):(0>m&&(v=m=0),m>b.page.maxw&&(m=b.page.maxw,v=0))}f=!1;if(b.rail.drag.dl)f=!0,"v"==b.rail.drag.dl?m=b.rail.drag.sl:"h"==b.rail.drag.dl&&(j=b.rail.drag.st);else{var r=Math.abs(r),k=Math.abs(k),l=b.opt.directionlockdeadzone;if("v"==b.rail.drag.ck){if(r>l&&k<=0.3*r)return b.rail.drag=!1,!0;k>l&&(b.rail.drag.dl= "f",e("body").scrollTop(e("body").scrollTop()))}else if("h"==b.rail.drag.ck){if(k>l&&r<=0.3*az)return b.rail.drag=!1,!0;r>l&&(b.rail.drag.dl="f",e("body").scrollLeft(e("body").scrollLeft()))}}b.synched("touchmove",function(){b.rail.drag&&2==b.rail.drag.pt&&(b.prepareTransition&&b.prepareTransition(0),b.rail.scrollable&&b.setScrollTop(j),b.scrollmom.update(v,g),b.railh&&b.railh.scrollable?(b.setScrollLeft(m),b.showCursor(j,m)):b.showCursor(j),h.isie10&&document.selection.clear())});h.ischrome&&b.istouchcapable&& (f=!1);if(f)return b.cancelEvent(d)}}}if(h.cantouch||b.opt.touchbehavior)b.onpreventclick=function(d){if(b.preventclick)return b.preventclick.tg.onclick=b.preventclick.click,b.preventclick=!1,b.cancelEvent(d)},b.onmousedown=b.ontouchstart,b.onmouseup=b.ontouchend,b.onclick=h.isios?!1:function(d){return b.lastmouseup?(b.lastmouseup=!1,b.cancelEvent(d)):!0},b.onmousemove=b.ontouchmove,b.opt.grabcursorenabled&&h.cursorgrabvalue&&(b.css(b.ispage?b.doc:b.win,{cursor:h.cursorgrabvalue}),b.css(b.rail,{cursor:h.cursorgrabvalue})); else{b.onmousedown=function(d,c){if(!(b.rail.drag&&1!=b.rail.drag.pt)){if(b.locked)return b.cancelEvent(d);b.cancelScroll();b.rail.drag={x:d.clientX,y:d.clientY,sx:b.scroll.x,sy:b.scroll.y,pt:1,hr:!!c};var e=b.getTarget(d);!b.ispage&&h.hasmousecapture&&e.setCapture();b.isiframe&&!h.hasmousecapture&&(b.saved.csspointerevents=b.doc.css("pointer-events"),b.css(b.doc,{"pointer-events":"none"}));return b.cancelEvent(d)}};b.onmouseup=function(d){if(b.rail.drag&&(h.hasmousecapture&&document.releaseCapture(), b.isiframe&&!h.hasmousecapture&&b.doc.css("pointer-events",b.saved.csspointerevents),1==b.rail.drag.pt))return b.rail.drag=!1,b.cancelEvent(d)};b.onmousemove=function(d){if(b.rail.drag&&1==b.rail.drag.pt){if(h.ischrome&&0==d.which)return b.onmouseup(d);b.cursorfreezed=!0;if(b.rail.drag.hr){b.scroll.x=b.rail.drag.sx+(d.clientX-b.rail.drag.x);0>b.scroll.x&&(b.scroll.x=0);var c=b.scrollvaluemaxw;b.scroll.x>c&&(b.scroll.x=c)}else b.scroll.y=b.rail.drag.sy+(d.clientY-b.rail.drag.y),0>b.scroll.y&&(b.scroll.y= 0),c=b.scrollvaluemax,b.scroll.y>c&&(b.scroll.y=c);b.synched("mousemove",function(){b.rail.drag&&1==b.rail.drag.pt&&(b.showCursor(),b.rail.drag.hr?b.doScrollLeft(Math.round(b.scroll.x*b.scrollratio.x)):b.doScrollTop(Math.round(b.scroll.y*b.scrollratio.y)))});return b.cancelEvent(d)}};var p=function(d){if(b.selectiondrag){if(d){var c=b.win.outerHeight();d=d.pageY-b.selectiondrag.top;0<d&&d<c&&(d=0);d>=c&&(d-=c);b.selectiondrag.df=d}0!=b.selectiondrag.df&&(b.doScrollBy(2*-Math.floor(b.selectiondrag.df/ 6)),b.debounced("doselectionscroll",function(){p()},50))}};b.hasTextSelected="getSelection"in document?function(){return 0<document.getSelection().rangeCount}:"selection"in document?function(){return"None"!=document.selection.type}:function(){return!1};b.onselectionstart=function(){b.ispage||(b.selectiondrag=b.win.offset())};b.onselectionend=function(){b.selectiondrag=!1};b.onselectiondrag=function(d){b.selectiondrag&&b.hasTextSelected()&&b.debounced("selectionscroll",function(){p(d)},250)}}(h.cantouch|| b.opt.touchbehavior)&&b.bind(b.win,"mousedown",b.onmousedown);h.hasmstouch&&(b.css(b.rail,{"-ms-touch-action":"none"}),b.css(b.cursor,{"-ms-touch-action":"none"}),b.bind(b.win,"MSPointerDown",b.ontouchstart),b.bind(document,"MSPointerUp",b.ontouchend),b.bind(document,"MSPointerMove",b.ontouchmove),b.bind(b.cursor,"MSGestureHold",function(b){b.preventDefault()}),b.bind(b.cursor,"contextmenu",function(b){b.preventDefault()}));this.istouchcapable&&(b.bind(b.win,"touchstart",b.ontouchstart),b.bind(document, "touchend",b.ontouchend),b.bind(document,"touchcancel",b.ontouchend),b.bind(document,"touchmove",b.ontouchmove));b.bind(b.cursor,"mousedown",b.onmousedown);b.bind(b.cursor,"mouseup",b.onmouseup);b.railh&&(b.bind(b.cursorh,"mousedown",function(d){b.onmousedown(d,!0)}),b.bind(b.cursorh,"mouseup",function(d){if(!(b.rail.drag&&2==b.rail.drag.pt))return b.rail.drag=!1,b.hasmoving=!1,b.hideCursor(),h.hasmousecapture&&document.releaseCapture(),b.cancelEvent(d)}));b.bind(document,"mouseup",b.onmouseup);h.hasmousecapture&& b.bind(b.win,"mouseup",b.onmouseup);b.bind(document,"mousemove",b.onmousemove);b.onclick&&b.bind(document,"click",b.onclick);!h.cantouch&&!b.opt.touchbehavior&&(b.jqbind(b.rail,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor();b.rail.active=!0}),b.jqbind(b.rail,"mouseleave",function(){b.rail.active=!1;b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.rail,"click",function(d){b.doRailClick(d,!1,!1)}),b.bind(b.rail,"dblclick",function(d){b.doRailClick(d,!0,!1)}),b.bind(b.cursor, "click",function(d){b.cancelEvent(d)}),b.bind(b.cursor,"dblclick",function(d){b.cancelEvent(d)})),!b.ispage&&b.opt.enablescrollonselection&&(b.bind(b.win[0],"mousedown",b.onselectionstart),b.bind(document,"mouseup",b.onselectionend),b.bind(document,"mousemove",b.onselectiondrag)),b.railh&&(b.jqbind(b.railh,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor();b.rail.active=!0}),b.jqbind(b.railh,"mouseleave",function(){b.rail.active=!1;b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.railh, "click",function(d){b.doRailClick(d,!1,!0)}),b.bind(b.railh,"dblclick",function(d){b.doRailClick(d,!0,!0)}),b.bind(b.cursorh,"click",function(d){b.cancelEvent(d)}),b.bind(b.cursorh,"dblclick",function(d){b.cancelEvent(d)}))),b.zoom&&(b.jqbind(b.zoom,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor();b.rail.active=!0}),b.jqbind(b.zoom,"mouseleave",function(){b.rail.active=!1;b.rail.drag||b.hideCursor()})));b.opt.enablemousewheel&&(b.isiframe||b.bind(h.isie&&b.ispage?document:b.docscroll, "mousewheel",b.onmousewheel),b.bind(b.rail,"mousewheel",b.onmousewheel),b.railh&&b.bind(b.railh,"mousewheel",b.onmousewheelhr));!b.ispage&&!h.cantouch&&!/HTML|BODY/.test(b.win[0].nodeName)&&(b.win.attr("tabindex")||b.win.attr({tabindex:J++}),b.jqbind(b.win,"focus",function(d){D=b.getTarget(d).id||!0;b.hasfocus=!0;b.canshowonmouseevent&&b.noticeCursor()}),b.jqbind(b.win,"blur",function(){D=!1;b.hasfocus=!1}),b.jqbind(b.win,"mouseenter",function(d){F=b.getTarget(d).id||!0;b.hasmousefocus=!0;b.canshowonmouseevent&& b.noticeCursor()}),b.jqbind(b.win,"mouseleave",function(){F=!1;b.hasmousefocus=!1}))}b.onkeypress=function(d){if(b.locked&&0==b.page.maxh)return!0;d=d?d:window.e;var c=b.getTarget(d);if(c&&/INPUT|TEXTAREA|SELECT|OPTION/.test(c.nodeName)&&(!c.getAttribute("type")&&!c.type||!/submit|button|cancel/i.tp))return!0;if(b.hasfocus||b.hasmousefocus&&!D||b.ispage&&!D&&!F){c=d.keyCode;if(b.locked&&27!=c)return b.cancelEvent(d);var e=d.ctrlKey||!1,f=d.shiftKey||!1,r=!1;switch(c){case 38:case 63233:b.doScrollBy(72); r=!0;break;case 40:case 63235:b.doScrollBy(-72);r=!0;break;case 37:case 63232:b.railh&&(e?b.doScrollLeft(0):b.doScrollLeftBy(72),r=!0);break;case 39:case 63234:b.railh&&(e?b.doScrollLeft(b.page.maxw):b.doScrollLeftBy(-72),r=!0);break;case 33:case 63276:b.doScrollBy(b.view.h);r=!0;break;case 34:case 63277:b.doScrollBy(-b.view.h);r=!0;break;case 36:case 63273:b.railh&&e?b.doScrollPos(0,0):b.doScrollTo(0);r=!0;break;case 35:case 63275:b.railh&&e?b.doScrollPos(b.page.maxw,b.page.maxh):b.doScrollTo(b.page.maxh); r=!0;break;case 32:b.opt.spacebarenabled&&(f?b.doScrollBy(b.view.h):b.doScrollBy(-b.view.h),r=!0);break;case 27:b.zoomactive&&(b.doZoom(),r=!0)}if(r)return b.cancelEvent(d)}};b.opt.enablekeyboard&&b.bind(document,h.isopera&&!h.isopera12?"keypress":"keydown",b.onkeypress);b.bind(window,"resize",b.lazyResize);b.bind(window,"orientationchange",b.lazyResize);b.bind(window,"load",b.lazyResize);if(h.ischrome&&!b.ispage&&!b.haswrapper){var t=b.win.attr("style"),f=parseFloat(b.win.css("width"))+1;b.win.css("width", f);b.synched("chromefix",function(){b.win.attr("style",t)})}b.onAttributeChange=function(){b.lazyResize(250)};!b.ispage&&!b.haswrapper&&(!1!==B?(b.observer=new B(function(d){d.forEach(b.onAttributeChange)}),b.observer.observe(b.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),b.observerremover=new B(function(d){d.forEach(function(d){if(0<d.removedNodes.length)for(var c in d.removedNodes)if(d.removedNodes[c]==b.win[0])return b.remove()})}),b.observerremover.observe(b.win[0].parentNode, {childList:!0,characterData:!1,attributes:!1,subtree:!1})):(b.bind(b.win,h.isie&&!h.isie9?"propertychange":"DOMAttrModified",b.onAttributeChange),h.isie9&&b.win[0].attachEvent("onpropertychange",b.onAttributeChange),b.bind(b.win,"DOMNodeRemoved",function(d){d.target==b.win[0]&&b.remove()})));!b.ispage&&b.opt.boxzoom&&b.bind(window,"resize",b.resizeZoom);b.istextarea&&b.bind(b.win,"mouseup",b.lazyResize);b.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var u=function(d){b.iframexd=!1;try{var c= "contentDocument"in this?this.contentDocument:this.contentWindow.document}catch(f){b.iframexd=!0,c=!1}if(b.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;b.forcescreen=!0;b.isiframe&&(b.iframe={doc:e(c),html:b.doc.contents().find("html")[0],body:b.doc.contents().find("body")[0]},b.getContentSize=function(){return{w:Math.max(b.iframe.html.scrollWidth,b.iframe.body.scrollWidth),h:Math.max(b.iframe.html.scrollHeight,b.iframe.body.scrollHeight)}},b.docscroll= e(b.iframe.body));!h.isios&&b.opt.iframeautoresize&&!b.isiframe&&(b.win.scrollTop(0),b.doc.height(""),d=Math.max(c.getElementsByTagName("html")[0].scrollHeight,c.body.scrollHeight),b.doc.height(d));b.lazyResize(30);h.isie7&&b.css(e(b.iframe.html),{"overflow-y":"hidden"});b.css(e(b.iframe.body),{"overflow-y":"hidden"});"contentWindow"in this?b.bind(this.contentWindow,"scroll",b.onscroll):b.bind(c,"scroll",b.onscroll);b.opt.enablemousewheel&&b.bind(c,"mousewheel",b.onmousewheel);b.opt.enablekeyboard&& b.bind(c,h.isopera?"keypress":"keydown",b.onkeypress);if(h.cantouch||b.opt.touchbehavior)b.bind(c,"mousedown",b.onmousedown),b.bind(c,"mousemove",function(d){b.onmousemove(d,!0)}),b.opt.grabcursorenabled&&h.cursorgrabvalue&&b.css(e(c.body),{cursor:h.cursorgrabvalue});b.bind(c,"mouseup",b.onmouseup);b.zoom&&(b.opt.dblclickzoom&&b.bind(c,"dblclick",b.doZoom),b.ongesturezoom&&b.bind(c,"gestureend",b.ongesturezoom))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){u.call(b.doc[0], !1)},500);b.bind(this.doc,"load",u)}};this.showCursor=function(d,c){b.cursortimeout&&(clearTimeout(b.cursortimeout),b.cursortimeout=0);b.rail&&(b.autohidedom&&(b.autohidedom.stop().css({opacity:b.opt.cursoropacitymax}),b.cursoractive=!0),"undefined"!=typeof d&&!1!==d&&(b.scroll.y=Math.round(1*d/b.scrollratio.y)),"undefined"!=typeof c&&(b.scroll.x=Math.round(1*c/b.scrollratio.x)),b.cursor.css({height:b.cursorheight,top:b.scroll.y}),b.cursorh&&(!b.rail.align&&b.rail.visibility?b.cursorh.css({width:b.cursorwidth, left:b.scroll.x+b.rail.width}):b.cursorh.css({width:b.cursorwidth,left:b.scroll.x}),b.cursoractive=!0),b.zoom&&b.zoom.stop().css({opacity:b.opt.cursoropacitymax}))};this.hideCursor=function(d){!b.cursortimeout&&b.rail&&b.autohidedom&&(b.cursortimeout=setTimeout(function(){if(!b.rail.active||!b.showonmouseevent)b.autohidedom.stop().animate({opacity:b.opt.cursoropacitymin}),b.zoom&&b.zoom.stop().animate({opacity:b.opt.cursoropacitymin}),b.cursoractive=!1;b.cursortimeout=0},d||b.opt.hidecursordelay))}; this.noticeCursor=function(d,c,e){b.showCursor(c,e);b.rail.active||b.hideCursor(d)};this.getContentSize=b.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:b.haswrapper?function(){return{w:b.doc.outerWidth()+parseInt(b.win.css("paddingLeft"))+parseInt(b.win.css("paddingRight")),h:b.doc.outerHeight()+parseInt(b.win.css("paddingTop"))+parseInt(b.win.css("paddingBottom"))}}: function(){return{w:b.docscroll[0].scrollWidth,h:b.docscroll[0].scrollHeight}};this.onResize=function(d,c){if(!b.win)return!1;if(!b.haswrapper&&!b.ispage){if("none"==b.win.css("display"))return b.visibility&&b.hideRail().hideRailHr(),!1;!b.hidden&&!b.visibility&&b.showRail().showRailHr()}var e=b.page.maxh,f=b.page.maxw,g=b.view.w;b.view={w:b.ispage?b.win.width():parseInt(b.win[0].clientWidth),h:b.ispage?b.win.height():parseInt(b.win[0].clientHeight)};b.page=c?c:b.getContentSize();b.page.maxh=Math.max(0, b.page.h-b.view.h);b.page.maxw=Math.max(0,b.page.w-b.view.w);if(b.page.maxh==e&&b.page.maxw==f&&b.view.w==g){if(b.ispage)return b;e=b.win.offset();if(b.lastposition&&(f=b.lastposition,f.top==e.top&&f.left==e.left))return b;b.lastposition=e}0==b.page.maxh?(b.hideRail(),b.scrollvaluemax=0,b.scroll.y=0,b.scrollratio.y=0,b.cursorheight=0,b.setScrollTop(0),b.rail.scrollable=!1):b.rail.scrollable=!0;0==b.page.maxw?(b.hideRailHr(),b.scrollvaluemaxw=0,b.scroll.x=0,b.scrollratio.x=0,b.cursorwidth=0,b.setScrollLeft(0), b.railh.scrollable=!1):b.railh.scrollable=!0;b.locked=0==b.page.maxh&&0==b.page.maxw;if(b.locked)return b.ispage||b.updateScrollBar(b.view),!1;!b.hidden&&!b.visibility?b.showRail().showRailHr():!b.hidden&&!b.railh.visibility&&b.showRailHr();b.istextarea&&b.win.css("resize")&&"none"!=b.win.css("resize")&&(b.view.h-=20);b.cursorheight=Math.min(b.view.h,Math.round(b.view.h*(b.view.h/b.page.h)));b.cursorheight=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorheight); b.cursorwidth=Math.min(b.view.w,Math.round(b.view.w*(b.view.w/b.page.w)));b.cursorwidth=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorwidth);b.scrollvaluemax=b.view.h-b.cursorheight-b.cursor.hborder;b.railh&&(b.railh.width=0<b.page.maxh?b.view.w-b.rail.width:b.view.w,b.scrollvaluemaxw=b.railh.width-b.cursorwidth-b.cursorh.wborder);b.ispage||b.updateScrollBar(b.view);b.scrollratio={x:b.page.maxw/b.scrollvaluemaxw,y:b.page.maxh/b.scrollvaluemax};b.getScrollTop()> b.page.maxh?b.doScrollTop(b.page.maxh):(b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x)),b.cursoractive&&b.noticeCursor());b.scroll.y&&0==b.getScrollTop()&&b.doScrollTo(Math.floor(b.scroll.y*b.scrollratio.y));return b};this.resize=b.onResize;this.lazyResize=function(d){d=isNaN(d)?30:d;b.delayed("resize",b.resize,d);return b};this._bind=function(d,c,e,f){b.events.push({e:d,n:c,f:e,b:f,q:!1});d.addEventListener?d.addEventListener(c, e,f||!1):d.attachEvent?d.attachEvent("on"+c,e):d["on"+c]=e};this.jqbind=function(d,c,f){b.events.push({e:d,n:c,f:f,q:!0});e(d).bind(c,f)};this.bind=function(d,c,e,f){var g="jquery"in d?d[0]:d;g.addEventListener?(h.cantouch&&/mouseup|mousedown|mousemove/.test(c)&&b._bind(g,"mousedown"==c?"touchstart":"mouseup"==c?"touchend":"touchmove",function(b){if(b.touches){if(2>b.touches.length){var d=b.touches.length?b.touches[0]:b;d.original=b;e.call(this,d)}}else b.changedTouches&&(d=b.changedTouches[0],d.original= b,e.call(this,d))},f||!1),b._bind(g,c,e,f||!1),"mousewheel"==c&&b._bind(g,"DOMMouseScroll",e,f||!1),h.cantouch&&"mouseup"==c&&b._bind(g,"touchcancel",e,f||!1)):b._bind(g,c,function(d){if((d=d||window.event||!1)&&d.srcElement)d.target=d.srcElement;"pageY"in d||(d.pageX=d.clientX+b.getScrollLeft(),d.pageY=d.clientY+b.getScrollTop());return!1===e.call(g,d)||!1===f?b.cancelEvent(d):!0})};this._unbind=function(b,c,e,f){b.removeEventListener?b.removeEventListener(c,e,f):b.detachEvent?b.detachEvent("on"+ c,e):b["on"+c]=!1};this.unbindAll=function(){for(var d=0;d<b.events.length;d++){var c=b.events[d];c.q?c.e.unbind(c.n,c.f):b._unbind(c.e,c.n,c.f,c.b)}};this.cancelEvent=function(b){b=b.original?b.original:b?b:window.event||!1;if(!b)return!1;b.preventDefault&&b.preventDefault();b.stopPropagation&&b.stopPropagation();b.preventManipulation&&b.preventManipulation();b.cancelBubble=!0;b.cancel=!0;return b.returnValue=!1};this.stopPropagation=function(b){b=b.original?b.original:b?b:window.event||!1;if(!b)return!1; if(b.stopPropagation)return b.stopPropagation();b.cancelBubble&&(b.cancelBubble=!0);return!1};this.showRail=function(){if(0!=b.page.maxh&&(b.ispage||"none"!=b.win.css("display")))b.visibility=!0,b.rail.visibility=!0,b.rail.css("display","block");return b};this.showRailHr=function(){if(!b.railh)return b;if(0!=b.page.maxw&&(b.ispage||"none"!=b.win.css("display")))b.railh.visibility=!0,b.railh.css("display","block");return b};this.hideRail=function(){b.visibility=!1;b.rail.visibility=!1;b.rail.css("display", "none");return b};this.hideRailHr=function(){if(!b.railh)return b;b.railh.visibility=!1;b.railh.css("display","none");return b};this.show=function(){b.hidden=!1;b.locked=!1;return b.showRail().showRailHr()};this.hide=function(){b.hidden=!0;b.locked=!0;return b.hideRail().hideRailHr()};this.toggle=function(){return b.hidden?b.show():b.hide()};this.remove=function(){b.stop();b.cursortimeout&&clearTimeout(b.cursortimeout);b.doZoomOut();b.unbindAll();!1!==b.observer&&b.observer.disconnect();!1!==b.observerremover&& b.observerremover.disconnect();b.events=[];b.cursor&&(b.cursor.remove(),b.cursor=null);b.cursorh&&(b.cursorh.remove(),b.cursorh=null);b.rail&&(b.rail.remove(),b.rail=null);b.railh&&(b.railh.remove(),b.railh=null);b.zoom&&(b.zoom.remove(),b.zoom=null);for(var d=0;d<b.saved.css.length;d++){var c=b.saved.css[d];c[0].css(c[1],"undefined"==typeof c[2]?"":c[2])}b.saved=!1;b.me.data("__nicescroll","");b.me=null;b.doc=null;b.docscroll=null;b.win=null;return b};this.scrollstart=function(d){this.onscrollstart= d;return b};this.scrollend=function(d){this.onscrollend=d;return b};this.scrollcancel=function(d){this.onscrollcancel=d;return b};this.zoomin=function(d){this.onzoomin=d;return b};this.zoomout=function(d){this.onzoomout=d;return b};this.isScrollable=function(b){b=b.target?b.target:b;if("OPTION"==b.nodeName)return!0;for(;b&&1==b.nodeType&&!/BODY|HTML/.test(b.nodeName);){var c=e(b),c=c.css("overflowY")||c.css("overflowX")||c.css("overflow")||"";if(/scroll|auto/.test(c))return b.clientHeight!=b.scrollHeight; b=b.parentNode?b.parentNode:!1}return!1};this.getViewport=function(b){for(b=b&&b.parentNode?b.parentNode:!1;b&&1==b.nodeType&&!/BODY|HTML/.test(b.nodeName);){var c=e(b),f=c.css("overflowY")||c.css("overflowX")||c.css("overflow")||"";if(/scroll|auto/.test(f)&&b.clientHeight!=b.scrollHeight||0<c.getNiceScroll().length)return c;b=b.parentNode?b.parentNode:!1}return!1};this.onmousewheel=function(d){if(b.locked)return!0;if(b.rail.drag)return b.cancelEvent(d);if(!b.rail.scrollable)return b.railh&&b.railh.scrollable? b.onmousewheelhr(d):!0;var c=+new Date,e=!1;b.opt.preservenativescrolling&&b.checkarea+600<c&&(b.nativescrollingarea=b.isScrollable(d),e=!0);b.checkarea=c;if(b.nativescrollingarea)return!0;if(d=j(d,!1,e))b.checkarea=0;return d};this.onmousewheelhr=function(d){if(b.locked||!b.railh.scrollable)return!0;if(b.rail.drag)return b.cancelEvent(d);var c=+new Date,e=!1;b.opt.preservenativescrolling&&b.checkarea+600<c&&(b.nativescrollingarea=b.isScrollable(d),e=!0);b.checkarea=c;return b.nativescrollingarea? !0:b.locked?b.cancelEvent(d):j(d,!0,e)};this.stop=function(){b.cancelScroll();b.scrollmon&&b.scrollmon.stop();b.cursorfreezed=!1;b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y));b.noticeCursor();return b};this.getTransitionSpeed=function(d){var c=Math.round(10*b.opt.scrollspeed);d=Math.min(c,Math.round(d/20*b.opt.scrollspeed));return 20<d?d:0};b.opt.smoothscroll?b.ishwscroll&&h.hastransition&&b.opt.usetransition?(this.prepareTransition=function(d,c){var e=c?20<d?d:0:b.getTransitionSpeed(d), f=e?h.prefixstyle+"transform "+e+"ms ease-out":"";if(!b.lasttransitionstyle||b.lasttransitionstyle!=f)b.lasttransitionstyle=f,b.doc.css(h.transitionstyle,f);return e},this.doScrollLeft=function(d,c){var e=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(d,e,c)},this.doScrollTop=function(d,c){var e=b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(e,d,c)},this.doScrollPos=function(c,e,f){var g=b.getScrollTop(),k=b.getScrollLeft();(0>(b.newscrolly-g)*(e-g)||0>(b.newscrollx-k)* (c-k))&&b.cancelScroll();!1==b.opt.bouncescroll&&(0>e?e=0:e>b.page.maxh&&(e=b.page.maxh),0>c?c=0:c>b.page.maxw&&(c=b.page.maxw));if(b.scrollrunning&&c==b.newscrollx&&e==b.newscrolly)return!1;b.newscrolly=e;b.newscrollx=c;b.newscrollspeed=f||!1;if(b.timer)return!1;b.timer=setTimeout(function(){var f=b.getScrollTop(),g=b.getScrollLeft(),k,j;k=c-g;j=e-f;k=Math.round(Math.sqrt(Math.pow(k,2)+Math.pow(j,2)));k=b.prepareTransition(b.newscrollspeed?b.newscrollspeed:k);b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm); 0<k&&(!b.scrollrunning&&b.onscrollstart&&b.onscrollstart.call(b,{type:"scrollstart",current:{x:g,y:f},request:{x:c,y:e},end:{x:b.newscrollx,y:b.newscrolly},speed:k}),h.transitionend?b.scrollendtrapped||(b.scrollendtrapped=!0,b.bind(b.doc,h.transitionend,b.onScrollEnd,!1)):(b.scrollendtrapped&&clearTimeout(b.scrollendtrapped),b.scrollendtrapped=setTimeout(b.onScrollEnd,k)),b.timerscroll={bz:new BezierClass(f,b.newscrolly,k,0,0,0.58,1),bh:new BezierClass(g,b.newscrollx,k,0,0,0.58,1)},b.cursorfreezed|| (b.timerscroll.tm=setInterval(function(){b.showCursor(b.getScrollTop(),b.getScrollLeft())},60)));b.synched("doScroll-set",function(){b.timer=0;b.scrollendtrapped&&(b.scrollrunning=!0);b.setScrollTop(b.newscrolly);b.setScrollLeft(b.newscrollx);if(!b.scrollendtrapped)b.onScrollEnd()})},50)},this.cancelScroll=function(){if(!b.scrollendtrapped)return!0;var c=b.getScrollTop(),e=b.getScrollLeft();b.scrollrunning=!1;h.transitionend||clearTimeout(h.transitionend);b.scrollendtrapped=!1;b._unbind(b.doc,h.transitionend, b.onScrollEnd);b.prepareTransition(0);b.setScrollTop(c);b.railh&&b.setScrollLeft(e);b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm);b.timerscroll=!1;b.cursorfreezed=!1;b.showCursor(c,e);return b},this.onScrollEnd=function(){b.scrollendtrapped&&b._unbind(b.doc,h.transitionend,b.onScrollEnd);b.scrollendtrapped=!1;b.prepareTransition(0);b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm);b.timerscroll=!1;var c=b.getScrollTop(),e=b.getScrollLeft();b.setScrollTop(c);b.railh&& b.setScrollLeft(e);b.noticeCursor(!1,c,e);b.cursorfreezed=!1;0>c?c=0:c>b.page.maxh&&(c=b.page.maxh);0>e?e=0:e>b.page.maxw&&(e=b.page.maxw);if(c!=b.newscrolly||e!=b.newscrollx)return b.doScrollPos(e,c,b.opt.snapbackspeed);b.onscrollend&&b.scrollrunning&&b.onscrollend.call(b,{type:"scrollend",current:{x:e,y:c},end:{x:b.newscrollx,y:b.newscrolly}});b.scrollrunning=!1}):(this.doScrollLeft=function(c){var e=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(c,e)},this.doScrollTop=function(c){var e= b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(e,c)},this.doScrollPos=function(c,e){function f(){if(b.cancelAnimationFrame)return!0;b.scrollrunning=!0;if(l=1-l)return b.timer=A(f)||1;var c=0,d=sy=b.getScrollTop();if(b.dst.ay){var d=b.bzscroll?b.dst.py+b.bzscroll.getNow()*b.dst.ay:b.newscrolly,e=d-sy;if(0>e&&d<b.newscrolly||0<e&&d>b.newscrolly)d=b.newscrolly;b.setScrollTop(d);d==b.newscrolly&&(c=1)}else c=1;var g=sx=b.getScrollLeft();if(b.dst.ax){g=b.bzscroll?b.dst.px+b.bzscroll.getNow()* b.dst.ax:b.newscrollx;e=g-sx;if(0>e&&g<b.newscrollx||0<e&&g>b.newscrollx)g=b.newscrollx;b.setScrollLeft(g);g==b.newscrollx&&(c+=1)}else c+=1;2==c?(b.timer=0,b.cursorfreezed=!1,b.bzscroll=!1,b.scrollrunning=!1,0>d?d=0:d>b.page.maxh&&(d=b.page.maxh),0>g?g=0:g>b.page.maxw&&(g=b.page.maxw),g!=b.newscrollx||d!=b.newscrolly?b.doScrollPos(g,d):b.onscrollend&&b.onscrollend.call(b,{type:"scrollend",current:{x:sx,y:sy},end:{x:b.newscrollx,y:b.newscrolly}})):b.timer=A(f)||1}e="undefined"==typeof e||!1===e?b.getScrollTop(!0): e;if(b.timer&&b.newscrolly==e&&b.newscrollx==c)return!0;b.timer&&z(b.timer);b.timer=0;var g=b.getScrollTop(),h=b.getScrollLeft();(0>(b.newscrolly-g)*(e-g)||0>(b.newscrollx-h)*(c-h))&&b.cancelScroll();b.newscrolly=e;b.newscrollx=c;if(!b.bouncescroll||!b.rail.visibility)0>b.newscrolly?b.newscrolly=0:b.newscrolly>b.page.maxh&&(b.newscrolly=b.page.maxh);if(!b.bouncescroll||!b.railh.visibility)0>b.newscrollx?b.newscrollx=0:b.newscrollx>b.page.maxw&&(b.newscrollx=b.page.maxw);b.dst={};b.dst.x=c-h;b.dst.y= e-g;b.dst.px=h;b.dst.py=g;var k=Math.round(Math.sqrt(Math.pow(b.dst.x,2)+Math.pow(b.dst.y,2)));b.dst.ax=b.dst.x/k;b.dst.ay=b.dst.y/k;var j=0,m=k;0==b.dst.x?(j=g,m=e,b.dst.ay=1,b.dst.py=0):0==b.dst.y&&(j=h,m=c,b.dst.ax=1,b.dst.px=0);k=b.getTransitionSpeed(k);b.bzscroll=0<k?b.bzscroll?b.bzscroll.update(m,k):new BezierClass(j,m,k,0,1,0,1):!1;if(!b.timer){(g==b.page.maxh&&e>=b.page.maxh||h==b.page.maxw&&c>=b.page.maxw)&&b.checkContentSize();var l=1;b.cancelAnimationFrame=!1;b.timer=1;b.onscrollstart&& !b.scrollrunning&&b.onscrollstart.call(b,{type:"scrollstart",current:{x:h,y:g},request:{x:c,y:e},end:{x:b.newscrollx,y:b.newscrolly},speed:k});f();(g==b.page.maxh&&e>=g||h==b.page.maxw&&c>=h)&&b.checkContentSize();b.noticeCursor()}},this.cancelScroll=function(){b.timer&&z(b.timer);b.timer=0;b.bzscroll=!1;b.scrollrunning=!1;return b}):(this.doScrollLeft=function(c,e){var f=b.getScrollTop();b.doScrollPos(c,f,e)},this.doScrollTop=function(c,e){var f=b.getScrollLeft();b.doScrollPos(f,c,e)},this.doScrollPos= function(c,e){var f=c>b.page.maxw?b.page.maxw:c;0>f&&(f=0);var g=e>b.page.maxh?b.page.maxh:e;0>g&&(g=0);b.synched("scroll",function(){b.setScrollTop(g);b.setScrollLeft(f)})},this.cancelScroll=function(){});this.doScrollBy=function(c,e){var f=0,f=e?Math.floor((b.scroll.y-c)*b.scrollratio.y):(b.timer?b.newscrolly:b.getScrollTop(!0))-c;if(b.bouncescroll){var g=Math.round(b.view.h/2);f<-g?f=-g:f>b.page.maxh+g&&(f=b.page.maxh+g)}b.cursorfreezed=!1;py=b.getScrollTop(!0);if(0>f&&0>=py)return b.noticeCursor(); if(f>b.page.maxh&&py>=b.page.maxh)return b.checkContentSize(),b.noticeCursor();b.doScrollTop(f)};this.doScrollLeftBy=function(c,e){var f=0,f=e?Math.floor((b.scroll.x-c)*b.scrollratio.x):(b.timer?b.newscrollx:b.getScrollLeft(!0))-c;if(b.bouncescroll){var g=Math.round(b.view.w/2);f<-g?f=-g:f>b.page.maxw+g&&(f=b.page.maxw+g)}b.cursorfreezed=!1;px=b.getScrollLeft(!0);if(0>f&&0>=px||f>b.page.maxw&&px>=b.page.maxw)return b.noticeCursor();b.doScrollLeft(f)};this.doScrollTo=function(c,e){e&&Math.round(c* b.scrollratio.y);b.cursorfreezed=!1;b.doScrollTop(c)};this.checkContentSize=function(){var c=b.getContentSize();(c.h!=b.page.h||c.w!=b.page.w)&&b.resize(!1,c)};b.onscroll=function(){b.rail.drag||b.cursorfreezed||b.synched("scroll",function(){b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y));b.railh&&(b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x)));b.noticeCursor()})};b.bind(b.docscroll,"scroll",b.onscroll);this.doZoomIn=function(c){if(!b.zoomactive){b.zoomactive=!0;b.zoomrestore= {style:{}};var f="position top left zIndex backgroundColor marginTop marginBottom marginLeft marginRight".split(" "),g=b.win[0].style,k;for(k in f){var j=f[k];b.zoomrestore.style[j]="undefined"!=typeof g[j]?g[j]:""}b.zoomrestore.style.width=b.win.css("width");b.zoomrestore.style.height=b.win.css("height");b.zoomrestore.padding={w:b.win.outerWidth()-b.win.width(),h:b.win.outerHeight()-b.win.height()};h.isios4&&(b.zoomrestore.scrollTop=e(window).scrollTop(),e(window).scrollTop(0));b.win.css({position:h.isios4? "absolute":"fixed",top:0,left:0,"z-index":C+100,margin:"0px"});f=b.win.css("backgroundColor");(""==f||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(f))&&b.win.css("backgroundColor","#fff");b.rail.css({"z-index":C+101});b.zoom.css({"z-index":C+102});b.zoom.css("backgroundPosition","0px -18px");b.resizeZoom();b.onzoomin&&b.onzoomin.call(b);return b.cancelEvent(c)}};this.doZoomOut=function(c){if(b.zoomactive)return b.zoomactive=!1,b.win.css("margin",""),b.win.css(b.zoomrestore.style),h.isios4&& e(window).scrollTop(b.zoomrestore.scrollTop),b.rail.css({"z-index":b.zindex}),b.zoom.css({"z-index":b.zindex}),b.zoomrestore=!1,b.zoom.css("backgroundPosition","0px 0px"),b.onResize(),b.onzoomout&&b.onzoomout.call(b),b.cancelEvent(c)};this.doZoom=function(c){return b.zoomactive?b.doZoomOut(c):b.doZoomIn(c)};this.resizeZoom=function(){if(b.zoomactive){var c=b.getScrollTop();b.win.css({width:e(window).width()-b.zoomrestore.padding.w+"px",height:e(window).height()-b.zoomrestore.padding.h+"px"});b.onResize(); b.setScrollTop(Math.min(b.page.maxh,c))}};this.init();e.nicescroll.push(this)},q=function(e){var c=this;this.nc=e;this.steptime=this.lasttime=this.speedy=this.speedx=this.lasty=this.lastx=0;this.snapy=this.snapx=!1;this.demuly=this.demulx=0;this.lastscrolly=this.lastscrollx=-1;this.timer=this.chky=this.chkx=0;this.time=function(){return+new Date};this.reset=function(e,f){c.stop();var j=c.time();c.steptime=0;c.lasttime=j;c.speedx=0;c.speedy=0;c.lastx=e;c.lasty=f;c.lastscrollx=-1;c.lastscrolly=-1}; this.update=function(e,f){var j=c.time();c.steptime=j-c.lasttime;c.lasttime=j;var j=f-c.lasty,b=e-c.lastx,l=c.nc.getScrollTop(),g=c.nc.getScrollLeft(),l=l+j,g=g+b;c.snapx=0>g||g>c.nc.page.maxw;c.snapy=0>l||l>c.nc.page.maxh;c.speedx=b;c.speedy=j;c.lastx=e;c.lasty=f};this.stop=function(){c.nc.unsynched("domomentum2d");c.timer&&clearTimeout(c.timer);c.timer=0;c.lastscrollx=-1;c.lastscrolly=-1};this.doSnapy=function(e,f){var j=!1;0>f?(f=0,j=!0):f>c.nc.page.maxh&&(f=c.nc.page.maxh,j=!0);0>e?(e=0,j=!0): e>c.nc.page.maxw&&(e=c.nc.page.maxw,j=!0);j&&c.nc.doScrollPos(e,f,c.nc.opt.snapbackspeed)};this.doMomentum=function(e){var f=c.time(),j=e?f+e:c.lasttime;e=c.nc.getScrollLeft();var b=c.nc.getScrollTop(),l=c.nc.page.maxh,g=c.nc.page.maxw;c.speedx=0<g?Math.min(60,c.speedx):0;c.speedy=0<l?Math.min(60,c.speedy):0;j=j&&50>=f-j;if(0>b||b>l||0>e||e>g)j=!1;e=c.speedx&&j?c.speedx:!1;if(c.speedy&&j&&c.speedy||e){var s=Math.max(16,c.steptime);50<s&&(e=s/50,c.speedx*=e,c.speedy*=e,s=50);c.demulxy=0;c.lastscrollx= c.nc.getScrollLeft();c.chkx=c.lastscrollx;c.lastscrolly=c.nc.getScrollTop();c.chky=c.lastscrolly;var n=c.lastscrollx,p=c.lastscrolly,q=function(){var b=600<c.time()-f?0.04:0.02;if(c.speedx&&(n=Math.floor(c.lastscrollx-c.speedx*(1-c.demulxy)),c.lastscrollx=n,0>n||n>g))b=0.1;if(c.speedy&&(p=Math.floor(c.lastscrolly-c.speedy*(1-c.demulxy)),c.lastscrolly=p,0>p||p>l))b=0.1;c.demulxy=Math.min(1,c.demulxy+b);c.nc.synched("domomentum2d",function(){c.speedx&&(c.nc.getScrollLeft()!=c.chkx&&c.stop(),c.chkx= n,c.nc.setScrollLeft(n));c.speedy&&(c.nc.getScrollTop()!=c.chky&&c.stop(),c.chky=p,c.nc.setScrollTop(p));c.timer||(c.nc.hideCursor(),c.doSnapy(n,p))});1>c.demulxy?c.timer=setTimeout(q,s):(c.stop(),c.nc.hideCursor(),c.doSnapy(n,p))};q()}else c.doSnapy(c.nc.getScrollLeft(),c.nc.getScrollTop())}},f=e.fn.scrollTop;e.cssHooks.pageYOffset={get:function(s,c){return(c=e.data(s,"__nicescroll")||!1)&&c.ishwscroll?c.getScrollTop():f.call(s)},set:function(s,c){var k=e.data(s,"__nicescroll")||!1;k&&k.ishwscroll? k.setScrollTop(parseInt(c)):f.call(s,c);return this}};e.fn.scrollTop=function(s){if("undefined"==typeof s){var c=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return c&&c.ishwscroll?c.getScrollTop():f.call(this)}return this.each(function(){var c=e.data(this,"__nicescroll")||!1;c&&c.ishwscroll?c.setScrollTop(parseInt(s)):f.call(e(this),s)})};var n=e.fn.scrollLeft;e.cssHooks.pageXOffset={get:function(f,c){return(c=e.data(f,"__nicescroll")||!1)&&c.ishwscroll?c.getScrollLeft():n.call(f)},set:function(f, c){var k=e.data(f,"__nicescroll")||!1;k&&k.ishwscroll?k.setScrollLeft(parseInt(c)):n.call(f,c);return this}};e.fn.scrollLeft=function(f){if("undefined"==typeof f){var c=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return c&&c.ishwscroll?c.getScrollLeft():n.call(this)}return this.each(function(){var c=e.data(this,"__nicescroll")||!1;c&&c.ishwscroll?c.setScrollLeft(parseInt(f)):n.call(e(this),f)})};for(var y=function(f){var c=this;this.length=0;this.name="nicescrollarray";this.each=function(e){for(var f= 0;f<c.length;f++)e.call(c[f]);return c};this.push=function(e){c[c.length]=e;c.length++};this.eq=function(e){return c[e]};if(f)for(a=0;a<f.length;a++){var k=e.data(f[a],"__nicescroll")||!1;k&&(this[this.length]=k,this.length++)}return this},u=y.prototype,G="show hide toggle onResize resize remove stop doScrollPos".split(" "),w=function(e,c){e[c]=function(){var e=arguments;return this.each(function(){this[c].apply(this,e)})}},p=0;p<G.length;p++)w(u,G[p]);e.fn.getNiceScroll=function(f){return"undefined"== typeof f?new y(this):e.data(this[f],"__nicescroll")||!1};e.extend(e.expr[":"],{nicescroll:function(f){return e.data(f,"__nicescroll")?!0:!1}});e.fn.niceScroll=function(f,c){"undefined"==typeof c&&"object"==typeof f&&!("jquery"in f)&&(c=f,f=!1);var k=new y;"undefined"==typeof c&&(c={});f&&(c.doc=e(f),c.win=e(this));var m=!("doc"in c);!m&&!("win"in c)&&(c.win=e(this));this.each(function(){var f=e(this).data("__nicescroll")||!1;f||(c.doc=m?e(this):c.doc,f=new I(c,e(this)),e(this).data("__nicescroll", f));k.push(f)});return 1==k.length?k[0]:k};window.NiceScroll={getjQuery:function(){return e}};e.nicescroll||(e.nicescroll=new y,e.nicescroll.options=H)})(jQuery);